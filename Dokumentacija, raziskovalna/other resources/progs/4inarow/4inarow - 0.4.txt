	jmp start
	.org 42
ntrl	.EQU '=
ply1	.EQU 'O
ply2	.EQU 'X
currentTurn	.byte 'O
winner	.byte '=
	.org 100
resetGame	ldx #0
	ldaa #ntrl
loopClearBoard	staa 0,x
	inx
	cpx #42
	bne loopClearBoard
	ldaa #ply1
	staa currentTurn
	rts
drawBoard	stx 43
	staa 45
	ldx #41
loopDrawBoardPsh	ldaa 0,x
	psha
	dex
	cpx #$FFFF
	bne loopDrawBoardPsh
	ldx #$FB00
	clra
loopDrawBoardPul	pulb
	stab 0,x
	inx
	inca
	cmpa #7
	bne loopDrawBoardPul
	ldab #47
	clra
	abx
	cpx #$FC44
	bne loopDrawBoardPul
	ldx 43
	ldaa 45
	rts
start	jsr resetGame
	jsr drawBoard
round	nop
getInput	WAI
	ldab $FFF0
	stab $FB35
	cmpb #'1
	beq placeMove
	cmpb #'2
	beq placeMove
	cmpb #'3
	beq placeMove
	cmpb #'4
	beq placeMove
	cmpb #'5
	beq placeMove
	cmpb #'6
	beq placeMove
	cmpb #'7
	beq placeMove
	jmp getInput
placeMove	subb #49
	ldx #0
	abx
	ldab 0,x
	cmpb #ntrl
	bne getInput
	ldaa currentTurn
	staa 0,x
	jsr drawBoard
fallMove	ldab 7,x
	cmpb #ntrl
	bne endTurn
	ldab #ntrl
	stab 0,x
	ldab #7
	abx
	staa 0,x
	jsr drawBoard
	cpx #34
	bgt endTurn
	jmp fallMove
endTurn	jsr check
	cmpa #ply1
	beq stToPly2
	ldab #ply1
	stab currentTurn
	jmp round
stToPly2	ldab #ply2
	stab currentTurn
	jmp round
check	ldx #0
	staa 46
	stab 47
checkVer	ldaa 14,x
	cmpa #ntrl
	beq nextVer
	cmpa 21,x
	bne nextVer
	cmpa 28,x
	bne chkVerUp
	cmpa 7,x
	bne chkVerDn
	jmp endGame
chkVerUp	cmpa 7,x
	bne nextVer
	cmpa 0,x
	bne nextVer
	jmp endGame
chkVerDn	cmpa 35,x
	bne nextVer
	jmp endGame
nextVer	inx
	cpx #7
	bne checkVer
	ldx #0
	ldaa #0
	ldab #7
checkHor	ldaa 3,x
	cmpa #ntrl
	beq nextHor
	cmpa 2,x
	bne chkHor3
	cmpa 1,X
	bne chkHor2
	cmpa 0,X
	bne chkHor1
	jmp endGame
chkHor3	cmpa 6,x
	bne nextHor
chkHor2	cmpa 5,X
	bne nextHor
chkHor1	cmpa 4,X
	bne nextHor
	jmp endGame
nextHor	abx
	cpx #42
	bne checkHor








checkDia	ldx #3
	ldab #7
chkDia1	ldaa 18,x
	cmpa #ntrl
	beq chkDia2
	cmpa 12,x
	bne chkDia2
	cmpa 6,x
	bne chkDia2
	cmpa 0,x
	bne chkDia2
	jmp endGame
chkDia2	inx
	ldaa 18,x
	cmpa #ntrl
	beq chkDia3
	cmpa 12,x
	bne chkDia3
	cmpa 6,x
	bne chkDia3
	cmpa 0,x
	bne chkDia2d
	jmp endGame
chkDia2d	cmpa 24,x
	bne chkDia3
	jmp endGame
chkDia3	inx
	ldaa 18,x
	cmpa #ntrl
	beq chkDia4
	cmpa 12,x
	bne chkDia4
	cmpa 6,x
	bne chkDia3d2
	cmpa 0,x
	bne chkDia3d
	jmp endGame

chkDia3d2	cmpa 30,x
	bne chkDia4
chkDia3d	cmpa 24,x
	bne chkDia4
	jmp endGame


chkDia4	inx
	ldaa 18,x
	cmpa #ntrl
	beq chkDia5
	cmpa 12,x
	bne chkDia5
	cmpa 6,x
	bne chkDia4d2
	cmpa 0,x
	bne chkDia4d
	jmp endGame
chkDia4d2	cmpa 30,x
	bne chkDia5
chkDia4d	cmpa 24,x
	bne chkDia5
	jmp endGame
chkDia5	abx
	ldaa 18,x
	cmpa #ntrl
	beq chkDia6
	cmpa 12,x
	bne chkDia6
	cmpa 6,x
	bne chkDia6
	cmpa 0,x
	bne chkDia5d
	jmp endGame
chkDia5d	cmpa 24,x
	bne chkDia6
	jmp endGame
chkDia6	abx
	ldaa 18,x
	cmpa #ntrl
	beq chkUia
	cmpa 12,x
	bne chkUia
	cmpa 6,x
	bne chkUia
	cmpa 0,x
	bne chkUia
	jmp endGame












chkUia	ldx #3
	ldab #7
chkUia1	ldaa 24,x
	cmpa #ntrl
	beq chkUia2
	cmpa 16,x
	bne chkUia2
	cmpa 8,x
	bne chkUia2
	cmpa 0,x
	bne chkUia2
	jmp endGame
chkUia2	dex
	ldaa 24,x
	cmpa #ntrl
	beq chkUia2
	cmpa 16,x
	bne chkUia2
	cmpa 8,x
	bne chkUia3
	cmpa 0,x
	bne chkUia2d
	jmp endGame
chkUia2d	cmpa 24,x
	bne chkUia3
	jmp endGame
chkUia3	dex
	ldaa 24,x
	cmpa #ntrl
	beq chkUia2
	cmpa 16,x
	bne chkUia2
	cmpa 8,x
	bne chkUia3d2
	cmpa 0,x
	bne chkUia3d
	jmp endGame
chkUia3d2	cmpa 24,x
	bne chkUia4
chkUia3d	cmpa 30,x
	bne chkUia4
	jmp endGame
chkUia4	inx
	ldaa 18,x
	cmpa #ntrl
	beq chkUia5
	cmpa 12,x
	bne chkUia5
	cmpa 6,x
	bne chkUia4d2
	cmpa 0,x
	bne chkUia4d
	jmp endGame
chkUia4d2	cmpa 24,x
	bne chkUia5
chkUia4d	cmpa 30,x
	bne chkUia5
	jmp endGame
chkUia5	abx
	ldaa 18,x
	cmpa #ntrl
	beq chkUia6
	cmpa 12,x
	bne chkUia6
	cmpa 6,x
	bne chkUia6
	cmpa 0,x
	bne chkUia5d
	jmp endGame
chkUia5d	cmpa 24,x
	bne chkUia6
	jmp endGame
chkUia6	abx
	ldaa 18,x
	cmpa #ntrl
	beq chkReturn
	cmpa 12,x
	bne chkReturn
	cmpa 6,x
	bne chkReturn
	cmpa 0,x
	bne chkReturn
	jmp endGame
chkReturn	ldaa 46
	ldab 47
	rts

endGame	staa winner
	nop



















